<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Universe Odyssey - Daily Quiz</title>
  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/quiz.css" />
  <meta http-equiv="refresh" content="0; url=/quiz" />
</head>

<body>
  <nav class="navbar"><a href="/" class="navbar-brand">ü™ê Universe Odyssey</a></nav>
  <main class="container">
    <div class="ui-hero">
      <h1 class="title">Daily Quiz</h1>
      <p class="subtitle muted">Redirecting to the app‚Ä¶</p>
    </div>
    <div class="missions-loading">Loading‚Ä¶</div>
  </main>
  <script>window.location.href = '/quiz';</script>
</body>

</html>
<!-- Redirect fallback page, kept minimal intentionally. -->
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Universe Odyssey - Daily Quiz</title>
  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/quiz.css" />
  <meta http-equiv="refresh" content="0; url=/quiz" />
</head>

<body>
  <nav class="navbar"><a href="/" class="navbar-brand">ü™ê Universe Odyssey</a></nav>
  <main class="container">
    <div class="ui-hero">
      <h1 class="title">Daily Quiz</h1>
      <p class="subtitle muted">Redirecting to the app‚Ä¶</p>
    </div>
    <div class="missions-loading">Loading‚Ä¶</div>
  </main>
  <script>window.location.href = '/quiz';</script>
</body>

</html>
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Universe Odyssey - Daily Quiz</title>
  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/quiz.css" />
  <meta http-equiv="refresh" content="0; url=/quiz" />
</head>

<body>
  <nav class="navbar">
    <a href="/" class="navbar-brand">ü™ê Universe Odyssey</a>
    <ul class="navbar-nav">
      <li><a href="/">Home</a></li>
      <li><a href="/planets">Explore</a></li>
      <li><a href="/missions">Missions</a></li>
      <li><a href="/quiz" class="active">Daily Quiz</a></li>
      <li><a href="/leaderboard">Leaderboard</a></li>
    </ul>
  </nav>
  <main class="container">
    <div class="ui-hero">
      <h1 class="title">Daily Quiz</h1>
      <p class="subtitle muted">Redirecting to the app‚Ä¶</p>
    </div>
    <div class="missions-loading">Loading‚Ä¶</div>
    <script>window.location.href = '/quiz';</script>
  </main>
</body>

</html>
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Universe Odyssey - Daily Quiz</title>
  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/quiz.css" />
  <meta http-equiv="refresh" content="0; url=/quiz" />
</head>

<body>
  <nav class="navbar">
    <a href="/" class="navbar-brand">ü™ê Universe Odyssey</a>
    <ul class="navbar-nav">
      <li><a href="/">Home</a></li>
      <li><a href="/planets">Explore</a></li>
      <li><a href="/missions">Missions</a></li>
      <li><a href="/quiz" class="active">Daily Quiz</a></li>
      <li><a href="/leaderboard">Leaderboard</a></li>
    </ul>
  </nav>
  <main class="container">
    <div class="ui-hero">
      <h1 class="title">Daily Quiz</h1>
      <p class="subtitle muted">Redirecting to the app‚Ä¶</p>
    </div>
    <div class="missions-loading">Loading‚Ä¶</div>
    <script>window.location.href = '/quiz';</script>
  </main>
</body>

</html>
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Universe Odyssey - Daily Quiz</title>
  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/quiz.css" />
  <meta http-equiv="refresh" content="0; url=/quiz" />
</head>

<body>
  <nav class="navbar">
    <a href="/" class="navbar-brand">ü™ê Universe Odyssey</a>
    <ul class="navbar-nav">
      <li><a href="/">Home</a></li>
      <li><a href="/planets">Explore</a></li>
      <li><a href="/missions">Missions</a></li>
      <li><a href="/quiz" class="active">Daily Quiz</a></li>
      <li><a href="/leaderboard">Leaderboard</a></li>
    </ul>
  </nav>
  <main class="container">
    <div class="ui-hero">
      <h1 class="title">Daily Quiz</h1>
      <p class="subtitle muted">Redirecting to the app‚Ä¶</p>
    </div>
    <div class="missions-loading">Loading‚Ä¶</div>
    <script>window.location.href = '/quiz';</script>
  </main>
</body>

</html>
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Universe Odyssey - Daily Quiz</title>
  <link rel="stylesheet" href="/css/site.css" />
  <link rel="stylesheet" href="/css/quiz.css" />
</head>

<body>
  <nav class="navbar">
    <a href="/" class="navbar-brand">ü™ê Universe Odyssey</a>
    <ul class="navbar-nav">
      <li><a href="/">Home</a></li>
      <li><a href="/planets">Explore</a></li>
      <li><a href="/missions">Missions</a></li>
      <li><a href="/quiz" class="active">Daily Quiz</a></li>
      <li><a href="/leaderboard">Leaderboard</a></li>
    </ul>
  </nav>

  <meta http-equiv="refresh" content="0; url=/quiz" />
  <main class="container quiz-page" id="root">
    <div class="ui-hero">
      <h1 class="title">Daily Quiz</h1>
      <p class="subtitle muted">Take the daily quiz ‚Äî earn points and climb the leaderboard.</p>
    </div>

    <div id="error" class="missions-error" style="display:none;"></div>
    <div id="loading" class="missions-loading">Loading today's quiz‚Ä¶</div>
    <div id="quiz" style="display:none;"></div>
    <div id="result" style="display:none; margin-top:16px;"></div>
  </main>

  <script>window.location.href = '/quiz';</script>
  async function initQuiz(){
  const loadingEl = document.getElementById('loading');
  const quizEl = document.getElementById('quiz');
  const errorEl = document.getElementById('error');
  const resultEl = document.getElementById('result');
  try{
  const resp = await fetch('/api/quiz/today', { credentials: 'include' });
  if(resp.status === 204 || resp.status === 404){
  loadingEl.style.display = 'none';
  errorEl.style.display = 'block';
  errorEl.innerHTML = '<p>No quiz available today. Check back later.</p>';
  return;
  }
  if(resp.status === 401){ window.location.href = '/login.html'; return; }
  const quiz = await resp.json();
  loadingEl.style.display = 'none';
  quizEl.style.display = 'block';
  renderQuiz(quiz);
  }catch(e){
  loadingEl.style.display = 'none';
  errorEl.style.display = 'block';
  errorEl.innerHTML = '<p>Failed to fetch quiz. Please try again later.</p>';
  }

  function renderQuiz(q){
  quizEl.innerHTML = '';
  if(q.completed){
  resultEl.style.display = 'block';
  resultEl.innerHTML = `\n+ <div class="mission-card visible completed-card">\n+ <div class="mission-card-content">\n+
      <h2 class="mission-card-title">Quiz Completed</h2>\n+ <p class="mission-desc">Nice work ‚Äî you scored
        <strong>${q.previousScore}</strong> points!
      </p>\n+ <p class="mission-desc">Your total points:
        <strong>${q.totalPoints||0}</strong>
      </p>\n+ <div style="margin-top:12px">\n+ <a href="/leaderboard.html" class="cta-btn">See Leaderboard</a>\n+ </div>
      \n+
    </div>\n+ </div>`;
  return;
  }

  const form = document.createElement('form');
  const answers = {};
  q.questions.forEach((quest, idx) => {
  const section = document.createElement('section');
  section.className = 'mission-card fade-up';
  section.innerHTML = `<div class="mission-card-content">\n+ <h3 class="mission-card-title">${idx+1}.
      ${escapeHtml(quest.text)}</h3>\n+ <div class="mission-desc">${escapeHtml(quest.hint||'')}</div>\n+ <div
      class="quiz-opts" id="q-${quest.id}-opts"></div>\n+ </div>`;
  const optsEl = section.querySelector(`#q-${quest.id}-opts`);
  quest.options.forEach((opt, i) => {
  const optId = `q-${quest.id}-o-${i}`;
  const label = document.createElement('label');
  label.className = 'quiz-option';
  label.innerHTML = `<input type="radio" name="q-${quest.id}" id="${optId}" value="${i}" /> ${escapeHtml(opt)}`;
  optsEl.appendChild(label);
  label.querySelector('input').addEventListener('change', () => answers[quest.id]=i);
  });
  form.appendChild(section);
  });

  const submitBtn = document.createElement('button');
  submitBtn.type = 'button';
  submitBtn.className = 'cta-btn';
  submitBtn.textContent = 'Submit Answers';
  submitBtn.addEventListener('click', async () => {
  // validators
  if(Object.keys(answers).length !== q.questions.length){
  errorEl.style.display = 'block'; errorEl.innerHTML = '<p>Please answer all questions before submitting.</p>'; return;
  }
  submitBtn.disabled = true; submitBtn.textContent = 'Submitting...';
  try{
  const payload = { quizId: q.id, answers };
  const res = await fetch(`/api/quiz/${q.id}/submit`, { method: 'POST', headers: {'Content-Type':'application/json'},
  body: JSON.stringify(payload), credentials: 'include' });
  if(res.status === 401){ window.location.href = '/login.html'; return; }
  if(res.status === 409){ errorEl.style.display='block'; errorEl.innerHTML='<p>You have already submitted this quiz.</p>
  '; submitBtn.disabled=false; submitBtn.textContent='Submit Answers'; return; }
  const r = await res.json();
  // show results
  quizEl.style.display='none';
  resultEl.style.display = 'block';
  resultEl.innerHTML = `\n+ <div class="mission-card visible completed-card">\n+ <div class="mission-card-content">\n+
      <h2 class="mission-card-title">Quiz Completed</h2>\n+ <p class="mission-desc">Nice work ‚Äî you scored
        <strong>${r.score}</strong> points!
      </p>\n+ <p class="mission-desc">Your total points:
        <strong>${r.totalPoints||0}</strong>
      </p>\n+ <div style="margin-top:12px">\n+ <a href="/leaderboard.html" class="cta-btn">See Leaderboard</a>\n+ </div>
      \n+
    </div>\n+ </div>`;
  }catch(e){ errorEl.style.display='block'; errorEl.innerHTML='<p>Submission failed ‚Äî please try again.</p>';
  submitBtn.disabled=false; submitBtn.textContent='Submit Answers'; }
  });

  form.appendChild(document.createElement('hr'));
  form.appendChild(submitBtn);
  quizEl.appendChild(form);
  }

  function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>
      ':'&gt;','"':'&quot;',"'":"&#39;"})[c]); }
      }
      initQuiz();
      </script>
</body>

</html>